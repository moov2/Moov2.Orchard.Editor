!function(){var e,n,t,a,i=!1,u=function(e){return e&&e.endsWith("</p>")||(e+="<p><br /></p>"),e},o=function(){t=document.querySelector(".js-editor-medium-element"),a=document.querySelector(".js-editor-custom-css")},s=function(){var e="instance";e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)"),t=n.exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},d=function(){o(),i||v({action:"init",id:e})},l=function(){return n.serialize()[n.elements[0].id].value},c=function(o){o.value=u(o.value),t.value=o.value,n=new MediumEditor(t),n.subscribe("editableInput",p),""!==a.value&&(n.elements[0].className+=" "+a.value),n.elements[0].setAttribute("data-instance-id",e),$(t).mediumInsert({editor:n,addons:{images:!1,embeds:!1,orchardMedia:!0}}),n.elements&&n.elements.length>0&&(n.elements[0].style.display="block"),i=!0},r=function(e){var n=JSON.parse(e.data);"update"===n.action&&m(n)},m=function(e){var t=""===e.value;i||c(e),e.value=u(e.value),n.setContent(e.value),t&&f()},v=function(e){window.parent.postMessage(e,"*")},p=function(){v({action:"update",id:e,value:l()})},f=function(){n&&(n.selectElement(n.elements[0]),MediumEditor.selection.moveCursor(document,n.elements[0],0))};e=s(),document.addEventListener("DOMContentLoaded",d),window.addEventListener("message",r)}();